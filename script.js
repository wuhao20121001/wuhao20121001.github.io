// 中英文翻译数据
const i18n = {
    zh: {
        site_title: '智能驾驶方案对比',
        nav_home: '首页',
        nav_brands: '品牌列表',
        nav_compare: '方案对比',
        nav_about: '关于我们',
        hero_title: '中外智能驾驶方案全面对比',
        hero_desc: '深入分析全球各品牌智能驾驶技术的性能、特点和应用场景',
        hero_btn_brands: '查看品牌列表',
        hero_btn_compare: '开始对比',
        features_title: '我们的优势',
        feature_comprehensive: '全面覆盖',
        feature_comprehensive_desc: '涵盖国内外主流智能驾驶品牌和方案',
        feature_professional: '专业分析',
        feature_professional_desc: '深入解析各方案的技术特点和性能表现',
        feature_intuitive: '直观对比',
        feature_intuitive_desc: '可视化对比工具，一目了然各方案差异',
        feature_updated: '持续更新',
        feature_updated_desc: '实时追踪智能驾驶技术的最新发展',
        brands_preview_title: '热门品牌',
        brands_title: '中外智能驾驶品牌方案',
        brands_desc: '以下是全球主流智能驾驶品牌及其方案的详细信息',
        filter_title: '筛选条件',
        filter_origin: '品牌 origin',
        filter_level: '自动驾驶等级',
        filter_sensor: '传感器配置',
        filter_all: '全部',
        filter_sensor_lidar: '激光雷达',
        filter_sensor_camera: '摄像头为主',
        filter_apply: '应用筛选',
        filter_reset: '重置筛选',
        compare_title: '智能驾驶方案对比',
        compare_desc: '选择多个品牌，对比它们的智能驾驶方案性能和特点',
        compare_selector_title: '选择要对比的品牌',
        compare_brand1: '品牌 1',
        compare_brand2: '品牌 2',
        compare_brand3: '品牌 3',
        compare_brand4: '品牌 4',
        compare_start: '开始对比',
        about_title: '关于我们',
        about_mission: '我们的使命',
        about_mission_desc: '智能驾驶技术正在改变我们的出行方式，各种品牌和方案层出不穷。我们的使命是为用户提供全面、客观、专业的智能驾驶方案对比信息，帮助用户了解不同品牌智能驾驶技术的特点、性能和应用场景，从而做出更明智的选择。',
        about_content: '我们的内容',
        about_content_desc: '我们收集了全球主流智能驾驶品牌的方案信息，包括：',
        about_chinese_brands: '中国品牌：蔚来、小鹏、理想、华为等',
        about_foreign_brands: '外国品牌：特斯拉、奔驰、宝马、奥迪、丰田、本田等',
        about_content_detail: '每个方案都包含详细的技术参数、功能特点、价格信息以及优缺点分析。',
        about_advantages: '我们的优势',
        about_advantage_comprehensive: '<strong>全面覆盖：</strong>涵盖国内外主流智能驾驶品牌和方案',
        about_advantage_professional: '<strong>专业分析：</strong>深入解析各方案的技术特点和性能表现',
        about_advantage_intuitive: '<strong>直观对比：</strong>可视化对比工具，一目了然各方案差异',
        about_advantage_updated: '<strong>持续更新：</strong>实时追踪智能驾驶技术的最新发展',
        about_version: '版本更新',
        version_1_1_0_ui: '全面升级UI设计，采用现代化渐变色彩和动画效果',
        version_1_1_0_filter: '增强品牌列表页面，添加筛选功能（品牌 origin、自动驾驶等级、传感器配置）',
        version_1_1_0_compare: '优化对比页面，添加对比结果分析功能',
        version_1_1_0_huawei: '更新华为智能驾驶方案为最新的乾崑智驾 ADS 4',
        version_1_1_0_brands: '添加比亚迪、长城、吉利、福特、通用、沃尔沃、现代等品牌',
        version_1_1_0_responsive: '改进响应式设计，提升移动端体验',
        version_1_1_0_code: '优化代码结构，提高可维护性',
        version_1_1_0_animations: '添加更多动画效果和过渡效果，提升用户体验',
        version_1_0_0_release: '初始版本发布',
        version_1_0_0_brands: '支持10个智能驾驶品牌的对比',
        version_1_0_0_list: '实现品牌列表和详情展示',
        version_1_0_0_compare: '支持多品牌对比功能',
        version_1_0_0_responsive: '响应式设计，适配不同设备',
        footer_copyright: '&copy; 2025 智能驾驶方案对比网站. 保留所有权利. | 版本 v1.1.0'
    },
    en: {
        site_title: 'Smart Driving Solutions Comparison',
        nav_home: 'Home',
        nav_brands: 'Brands',
        nav_compare: 'Compare',
        nav_about: 'About',
        hero_title: 'Comprehensive Comparison of Smart Driving Solutions',
        hero_desc: 'In-depth analysis of performance, features and application scenarios of smart driving technologies from global brands',
        hero_btn_brands: 'View Brands',
        hero_btn_compare: 'Start Comparison',
        features_title: 'Our Advantages',
        feature_comprehensive: 'Comprehensive Coverage',
        feature_comprehensive_desc: 'Covers mainstream smart driving brands and solutions at home and abroad',
        feature_professional: 'Professional Analysis',
        feature_professional_desc: 'In-depth analysis of technical characteristics and performance of each solution',
        feature_intuitive: 'Intuitive Comparison',
        feature_intuitive_desc: 'Visual comparison tool for clear differences between solutions',
        feature_updated: 'Continuous Updates',
        feature_updated_desc: 'Real-time tracking of the latest developments in smart driving technology',
        brands_preview_title: 'Popular Brands',
        brands_title: 'Smart Driving Brand Solutions',
        brands_desc: 'Below are detailed information about mainstream smart driving brands and their solutions worldwide',
        filter_title: 'Filter Conditions',
        filter_origin: 'Brand Origin',
        filter_level: 'Autopilot Level',
        filter_sensor: 'Sensor Configuration',
        filter_all: 'All',
        filter_sensor_lidar: 'LiDAR',
        filter_sensor_camera: 'Camera-based',
        filter_apply: 'Apply Filter',
        filter_reset: 'Reset Filter',
        compare_title: 'Smart Driving Solutions Comparison',
        compare_desc: 'Select multiple brands to compare their smart driving solutions performance and features',
        compare_selector_title: 'Select Brands to Compare',
        compare_brand1: 'Brand 1',
        compare_brand2: 'Brand 2',
        compare_brand3: 'Brand 3',
        compare_brand4: 'Brand 4',
        compare_start: 'Start Comparison',
        about_title: 'About Us',
        about_mission: 'Our Mission',
        about_mission_desc: 'Smart driving technology is changing our way of travel, with various brands and solutions emerging. Our mission is to provide users with comprehensive, objective, and professional smart driving solutions comparison information, helping users understand the characteristics, performance, and application scenarios of different brands\' smart driving technologies, thus making more informed choices.',
        about_content: 'Our Content',
        about_content_desc: 'We have collected information on mainstream smart driving brands worldwide, including:',
        about_chinese_brands: 'Chinese brands: NIO, Xpeng, Li Auto, Huawei, etc.',
        about_foreign_brands: 'Foreign brands: Tesla, Mercedes-Benz, BMW, Audi, Toyota, Honda, etc.',
        about_content_detail: 'Each solution includes detailed technical parameters, functional features, price information, as well as advantages and disadvantages analysis.',
        about_advantages: 'Our Advantages',
        about_advantage_comprehensive: '<strong>Comprehensive Coverage:</strong> Covers mainstream smart driving brands and solutions at home and abroad',
        about_advantage_professional: '<strong>Professional Analysis:</strong> In-depth analysis of technical characteristics and performance of each solution',
        about_advantage_intuitive: '<strong>Intuitive Comparison:</strong> Visual comparison tool for clear differences between solutions',
        about_advantage_updated: '<strong>Continuous Updates:</strong> Real-time tracking of the latest developments in smart driving technology',
        about_version: 'Version Updates',
        version_1_1_0_ui: 'Comprehensive UI design upgrade with modern gradient colors and animation effects',
        version_1_1_0_filter: 'Enhanced brand list page with filter function (brand origin, autopilot level, sensor configuration)',
        version_1_1_0_compare: 'Optimized comparison page with comparison result analysis function',
        version_1_1_0_huawei: 'Updated Huawei smart driving solution to the latest Kunpeng Smart Driving ADS 4',
        version_1_1_0_brands: 'Added brands: BYD, Great Wall, Geely, Ford, GM, Volvo, Hyundai, etc.',
        version_1_1_0_responsive: 'Improved responsive design for better mobile experience',
        version_1_1_0_code: 'Optimized code structure for better maintainability',
        version_1_1_0_animations: 'Added more animation and transition effects to enhance user experience',
        version_1_0_0_release: 'Initial version released',
        version_1_0_0_brands: 'Support for comparison of 10 smart driving brands',
        version_1_0_0_list: 'Implemented brand list and detail display',
        version_1_0_0_compare: 'Support for multi-brand comparison function',
        version_1_0_0_responsive: 'Responsive design for different devices',
        footer_copyright: '&copy; 2025 Smart Driving Solutions Comparison. All rights reserved. | Version v1.1.0'
    }
};

// 当前语言
let currentLang = localStorage.getItem('lang') || navigator.language.startsWith('zh') ? 'zh' : 'en';

// 语言切换函数
function switchLanguage(lang) {
    currentLang = lang;
    localStorage.setItem('lang', lang);
    
    // 更新语言切换按钮状态
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.getElementById(`lang-${lang}`).classList.add('active');
    
    // 切换页面上的所有文本
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (i18n[lang][key]) {
            // 处理HTML内容
            if (element.tagName === 'LI' && element.innerHTML.includes('<strong>')) {
                element.innerHTML = i18n[lang][key];
            } else {
                element.textContent = i18n[lang][key];
            }
        }
    });
    
    // 切换选项框中的文本
    document.querySelectorAll('option[data-i18n]').forEach(option => {
        const key = option.getAttribute('data-i18n');
        if (i18n[lang][key]) {
            option.textContent = i18n[lang][key];
        }
    });
    
    // 重新初始化动态内容
    if (window.location.pathname.includes('brands.html')) {
        // 重新加载品牌列表
        if (typeof initBrandsPage === 'function') {
            initBrandsPage();
        }
    } else if (window.location.pathname.includes('compare.html')) {
        // 重新加载对比页面
        if (typeof initComparePage === 'function') {
            initComparePage();
        }
    }
}

// 页面加载完成后初始化语言
window.addEventListener('DOMContentLoaded', function() {
    // 初始化语言切换按钮事件
    document.getElementById('lang-zh').addEventListener('click', () => switchLanguage('zh'));
    document.getElementById('lang-en').addEventListener('click', () => switchLanguage('en'));
    
    // 设置初始语言
    switchLanguage(currentLang);
});

// 智能驾驶品牌数据
const drivingBrands = {
    'tesla': {
        name: '特斯拉',
        solution: 'Autopilot/FSD',
        origin: '美国',
        level: 'L2-L3',
        sensors: '摄像头为主，辅助雷达',
        features: '自动变道、自动泊车、智能召唤、FSD Beta城市街道自动驾驶',
        price: 'FSD约6.4万元人民币',
        advantage: '算法成熟，数据积累丰富，城市街道自动驾驶能力强',
        disadvantage: '依赖摄像头，恶劣天气表现受影响，价格较高'
    },
    'nio': {
        name: '蔚来',
        solution: 'NOP+ (Navigate on Pilot Plus)',
        origin: '中国',
        level: 'L2+',
        sensors: '激光雷达+摄像头+雷达+超声波',
        features: '高速/城市NOP、自动变道、自动泊车、遥控泊车',
        price: 'NOP+订阅约380元/月',
        advantage: '激光雷达加持，感知能力强，换电模式支持',
        disadvantage: '城市NOP覆盖范围有限，高速表现仍需优化'
    },
    'xpeng': {
        name: '小鹏',
        solution: 'XPILOT 4.0',
        origin: '中国',
        level: 'L2+',
        sensors: '双激光雷达+摄像头+雷达+超声波',
        features: '城市NGP、高速NGP、自动变道、自动泊车、记忆泊车',
        price: 'XPILOT 4.0硬件免费，软件订阅约500元/月',
        advantage: '城市NGP表现优异，自动泊车能力强，性价比高',
        disadvantage: '高速NGP在复杂路况下仍需人工干预'
    },
    'lixiang': {
        name: '理想',
        solution: 'NOA (Navigation on Autopilot)',
        origin: '中国',
        level: 'L2+',
        sensors: '激光雷达+摄像头+雷达+超声波',
        features: '高速NOA、城市NOA、自动变道、自动泊车',
        price: 'NOA功能约3.98万元',
        advantage: '交互设计友好，辅助驾驶体验流畅，增程式续航无焦虑',
        disadvantage: '城市NOA覆盖城市较少，高速NOA变道策略保守'
    },
    'huawei': {
        name: '华为',
        solution: '乾崑智驾 ADS 4',
        origin: '中国',
        level: 'L2+',
        sensors: '激光雷达+摄像头+雷达+超声波',
        features: '高速NCA、城市NCA、自动变道、自动泊车、代客泊车、生态级安全',
        price: 'ADS 4.0软件包约4万元',
        advantage: '全栈自研，感知融合能力强，复杂场景处理能力优异，生态级安全',
        disadvantage: '仅搭载部分车型，生态覆盖有限'
    },
    'byd': {
        name: '比亚迪',
        solution: '天神之眼',
        origin: '中国',
        level: 'L2-L3',
        sensors: '摄像头+雷达+激光雷达(高端车型)',
        features: '高速辅助驾驶、城市辅助驾驶、自动变道、自动泊车、智能召唤',
        price: '天神之眼C免费标配，天神之眼A/B可选装',
        advantage: '覆盖全价格区间，硬件免费，普及度高',
        disadvantage: '高阶功能有待验证，算法成熟度仍需提升'
    },
    'greatwall': {
        name: '长城',
        solution: '咖啡智驾 (Coffee Pilot)',
        origin: '中国',
        level: 'L2-L3',
        sensors: '激光雷达+摄像头+雷达+超声波',
        features: '高速辅助驾驶、城市辅助驾驶、自动变道、自动泊车、记忆泊车',
        price: 'CoffeePilot Ultra选装约3万元',
        advantage: '全车冗余设计，安全性高，场景覆盖广',
        disadvantage: '品牌认知度有待提升，高端车型价格较高'
    },
    'geely': {
        name: '吉利',
        solution: '千里浩瀚',
        origin: '中国',
        level: 'L2+',
        sensors: '激光雷达+摄像头+雷达+超声波',
        features: '高速辅助驾驶、城市辅助驾驶、自动变道、自动泊车、遥控泊车',
        price: '部分车型标配，高端版本约2万元',
        advantage: '与沃尔沃技术共享，硬件配置高，性价比优',
        disadvantage: '城市辅助驾驶能力仍需优化，数据积累不足'
    },
    'ford': {
        name: '福特',
        solution: 'BlueCruise',
        origin: '美国',
        level: 'L2+',
        sensors: '摄像头+雷达+超声波',
        features: '高速辅助驾驶、自动变道、自动泊车',
        price: '选装包约2万元',
        advantage: '高速公路自动驾驶体验流畅，安全性高',
        disadvantage: '缺少激光雷达，城市辅助驾驶能力有限'
    },
    'gm': {
        name: '通用',
        solution: 'Super Cruise',
        origin: '美国',
        level: 'L2+',
        sensors: '摄像头+雷达+高精度地图',
        features: '高速辅助驾驶、自动变道、自动泊车',
        price: '选装包约3万元',
        advantage: '高精度地图加持，驾驶体验稳定，安全性高',
        disadvantage: '覆盖路段有限，升级费用较高'
    },
    'volvo': {
        name: '沃尔沃',
        solution: 'Pilot Assist',
        origin: '瑞典',
        level: 'L2',
        sensors: '摄像头+雷达+超声波',
        features: '自适应巡航、车道保持、自动紧急制动、碰撞预警',
        price: '部分车型标配',
        advantage: '安全性能优异，系统成熟可靠，豪华品牌背书',
        disadvantage: '辅助驾驶功能相对保守，缺少高阶自动驾驶能力'
    },
    'hyundai': {
        name: '现代',
        solution: 'Highway Driving Assist',
        origin: '韩国',
        level: 'L2',
        sensors: '摄像头+雷达+超声波',
        features: '自适应巡航、车道保持、自动变道、自动泊车',
        price: '部分车型标配',
        advantage: '性价比高，系统稳定可靠，燃油车混动车型均有搭载',
        disadvantage: '高级自动驾驶功能有限，缺少激光雷达支持'
    },
    'mercedes': {
        name: '奔驰',
        solution: 'DRIVE PILOT',
        origin: '德国',
        level: 'L3',
        sensors: '摄像头+雷达+激光雷达+高精度地图',
        features: '高速L3自动驾驶、自动变道、自动泊车',
        price: 'DRIVE PILOT选装约10万元',
        advantage: '全球首个量产L3级自动驾驶，安全性高，豪华品牌背书',
        disadvantage: '使用场景受限，仅支持特定高速路段，价格昂贵'
    },
    'bmw': {
        name: '宝马',
        solution: 'Driving Assistant Professional',
        origin: '德国',
        level: 'L2+',
        sensors: '摄像头+雷达+超声波',
        features: '高速辅助驾驶、自动变道、自动泊车、遥控泊车',
        price: '选装包约2.5万元',
        advantage: '驾驶体验流畅，与车辆操控性结合好，品牌溢价',
        disadvantage: '缺少激光雷达，感知能力相对较弱，城市辅助驾驶能力有限'
    },
    'audi': {
        name: '奥迪',
        solution: 'Audi AI: Pilot',
        origin: '德国',
        level: 'L2+',
        sensors: '摄像头+雷达+激光雷达(部分车型)',
        features: '高速辅助驾驶、自动变道、自动泊车、记忆泊车',
        price: '选装包约3万元',
        advantage: '与座舱系统融合好，高速表现稳定，豪华品牌体验',
        disadvantage: '激光雷达仅高端车型搭载，城市辅助驾驶能力有待提升'
    },
    'toyota': {
        name: '丰田',
        solution: 'Toyota Safety Sense 3.0',
        origin: '日本',
        level: 'L2',
        sensors: '摄像头+雷达',
        features: '自适应巡航、车道保持、自动紧急制动、车道偏离预警',
        price: '部分车型标配',
        advantage: '可靠性高，燃油经济性好，普及度高',
        disadvantage: '辅助驾驶功能相对基础，缺少高级自动驾驶能力'
    },
    'honda': {
        name: '本田',
        solution: 'Honda Sensing 360',
        origin: '日本',
        level: 'L2',
        sensors: '摄像头+雷达',
        features: '自适应巡航、车道保持、自动变道、自动泊车',
        price: '部分车型标配',
        advantage: '系统成熟可靠，性价比高，燃油车混动车型均有搭载',
        disadvantage: '高级自动驾驶功能有限，缺少激光雷达支持'
    }
};

// 页面加载完成后执行
document.addEventListener('DOMContentLoaded', function() {
    // 初始化对比页面
    if (window.location.pathname.includes('compare.html')) {
        initComparePage();
    }
    
    // 初始化品牌列表页面
    if (window.location.pathname.includes('brands.html')) {
        initBrandsPage();
    }
});

// 初始化对比页面
function initComparePage() {
    const selectors = document.querySelectorAll('.brand-selector');
    const compareBtn = document.getElementById('compareBtn');
    const compareTable = document.getElementById('compareTable');
    
    // 填充品牌选择器
    selectors.forEach(selector => {
        fillBrandSelector(selector);
    });
    
    // 对比按钮点击事件
    if (compareBtn) {
        compareBtn.addEventListener('click', function() {
            compareBrands();
        });
    }
    
    // 自动对比（当所有选择器都有值时）
    selectors.forEach(selector => {
        selector.addEventListener('change', function() {
            compareBrands();
        });
    });
}

// 填充品牌选择器
function fillBrandSelector(selector) {
    // 清空现有选项
    selector.innerHTML = '<option value="">选择品牌</option>';
    
    // 添加品牌选项
    for (const [key, brand] of Object.entries(drivingBrands)) {
        const option = document.createElement('option');
        option.value = key;
        option.textContent = `${brand.name} - ${brand.solution}`;
        selector.appendChild(option);
    }
}

// 对比品牌
function compareBrands() {
    const selectors = document.querySelectorAll('.brand-selector');
    const selectedBrands = [];
    
    // 获取选中的品牌
    selectors.forEach(selector => {
        if (selector.value) {
            selectedBrands.push(drivingBrands[selector.value]);
        }
    });
    
    // 更新对比表格
    updateCompareTable(selectedBrands);
}

// 更新对比表格
function updateCompareTable(brands) {
    const compareTable = document.getElementById('compareTable');
    if (!compareTable) return;
    
    // 清空现有表格内容
    compareTable.innerHTML = '';
    
    // 如果没有选择品牌，显示提示信息
    if (brands.length === 0) {
        compareTable.innerHTML = `
            <tr>
                <td colspan="5" style="text-align: center; padding: 4rem; color: #64748b;">
                    <h3>请选择至少一个品牌进行对比</h3>
                    <p>使用上方的选择器选择要对比的品牌</p>
                </td>
            </tr>
        `;
        
        // 清空对比结果
        updateCompareResults([]);
        return;
    }
    
    // 创建表头
    const thead = document.createElement('thead');
    const headerRow = document.createElement('tr');
    
    // 添加属性列
    const propertyHeader = document.createElement('th');
    propertyHeader.textContent = '对比项';
    headerRow.appendChild(propertyHeader);
    
    // 添加品牌列
    brands.forEach(brand => {
        const brandHeader = document.createElement('th');
        brandHeader.textContent = brand.name;
        headerRow.appendChild(brandHeader);
    });
    
    thead.appendChild(headerRow);
    compareTable.appendChild(thead);
    
    // 创建表格内容
    const tbody = document.createElement('tbody');
    
    // 对比属性列表
    const properties = [
        { key: 'solution', label: '智能驾驶方案' },
        { key: 'origin', label: '品牌 origin' },
        { key: 'level', label: '自动驾驶等级' },
        { key: 'sensors', label: '传感器配置' },
        { key: 'features', label: '主要功能' },
        { key: 'price', label: '价格' },
        { key: 'advantage', label: '优势' },
        { key: 'disadvantage', label: '劣势' }
    ];
    
    // 添加属性行
    properties.forEach(property => {
        const row = document.createElement('tr');
        
        // 属性名称
        const propertyCell = document.createElement('td');
        propertyCell.textContent = property.label;
        propertyCell.style.fontWeight = '600';
        row.appendChild(propertyCell);
        
        // 各品牌属性值
        brands.forEach(brand => {
            const valueCell = document.createElement('td');
            valueCell.textContent = brand[property.key];
            row.appendChild(valueCell);
        });
        
        tbody.appendChild(row);
    });
    
    compareTable.appendChild(tbody);
    
    // 生成对比结果分析
    updateCompareResults(brands);
}

// 更新对比结果分析
function updateCompareResults(brands) {
    const compareResults = document.getElementById('compareResults');
    if (!compareResults) return;
    
    // 清空现有结果
    compareResults.innerHTML = '';
    
    // 如果没有选择品牌，不显示结果
    if (brands.length === 0) {
        return;
    }
    
    // 添加结果标题
    const resultTitle = document.createElement('h3');
    resultTitle.textContent = '对比结果分析';
    compareResults.appendChild(resultTitle);
    
    // 生成综合分析
    const analysisCard = document.createElement('div');
    analysisCard.className = 'result-card';
    analysisCard.innerHTML = `
        <h4>综合分析</h4>
        <p>本次对比了 ${brands.length} 个智能驾驶方案，涵盖了 ${new Set(brands.map(b => b.origin)).size} 个国家/地区。</p>
        <p>自动驾驶等级分布：${getLevelDistribution(brands)}</p>
        <p>传感器配置：${getSensorDistribution(brands)}</p>
    `;
    compareResults.appendChild(analysisCard);
    
    // 生成优势对比
    const advantageCard = document.createElement('div');
    advantageCard.className = 'result-card';
    advantageCard.innerHTML = `
        <h4>优势对比</h4>
        <ul>${brands.map(brand => `<li><strong>${brand.name}：</strong>${brand.advantage}</li>`).join('')}</ul>
    `;
    compareResults.appendChild(advantageCard);
    
    // 生成劣势对比
    const disadvantageCard = document.createElement('div');
    disadvantageCard.className = 'result-card';
    disadvantageCard.innerHTML = `
        <h4>劣势对比</h4>
        <ul>${brands.map(brand => `<li><strong>${brand.name}：</strong>${brand.disadvantage}</li>`).join('')}</ul>
    `;
    compareResults.appendChild(disadvantageCard);
    
    // 生成价格对比
    const priceCard = document.createElement('div');
    priceCard.className = 'result-card';
    priceCard.innerHTML = `
        <h4>价格对比</h4>
        <ul>${brands.map(brand => `<li><strong>${brand.name}：</strong>${brand.price}</li>`).join('')}</ul>
    `;
    compareResults.appendChild(priceCard);
}

// 获取自动驾驶等级分布
function getLevelDistribution(brands) {
    const levels = brands.map(b => b.level);
    const counts = {};
    
    levels.forEach(level => {
        counts[level] = (counts[level] || 0) + 1;
    });
    
    return Object.entries(counts).map(([level, count]) => `${level} (${count}个)`).join(', ');
}

// 获取传感器配置分布
function getSensorDistribution(brands) {
    const hasLidar = brands.filter(b => b.sensors.includes('激光雷达')).length;
    const cameraBased = brands.filter(b => b.sensors.includes('摄像头为主')).length;
    
    return `激光雷达配置：${hasLidar}个，摄像头为主：${cameraBased}个`;
}

// 初始化品牌列表页面
function initBrandsPage() {
    const brandsList = document.getElementById('brandsList');
    if (!brandsList) return;
    
    // 初始化筛选功能
    initFilters();
    
    // 显示所有品牌
    displayBrands(drivingBrands);
}

// 初始化筛选功能
function initFilters() {
    const originFilter = document.getElementById('originFilter');
    const levelFilter = document.getElementById('levelFilter');
    const sensorFilter = document.getElementById('sensorFilter');
    const filterBtn = document.getElementById('filterBtn');
    const resetBtn = document.getElementById('resetBtn');
    
    // 筛选按钮点击事件
    filterBtn.addEventListener('click', applyFilters);
    
    // 重置按钮点击事件
    resetBtn.addEventListener('click', resetFilters);
    
    // 筛选条件变化事件
    originFilter.addEventListener('change', applyFilters);
    levelFilter.addEventListener('change', applyFilters);
    sensorFilter.addEventListener('change', applyFilters);
}

// 应用筛选条件
function applyFilters() {
    const originFilter = document.getElementById('originFilter').value;
    const levelFilter = document.getElementById('levelFilter').value;
    const sensorFilter = document.getElementById('sensorFilter').value;
    
    // 筛选品牌
    const filteredBrands = {};
    
    for (const [key, brand] of Object.entries(drivingBrands)) {
        let match = true;
        
        // 品牌 origin筛选
        if (originFilter && brand.origin !== originFilter) {
            match = false;
        }
        
        // 自动驾驶等级筛选
        if (levelFilter && !brand.level.includes(levelFilter)) {
            match = false;
        }
        
        // 传感器配置筛选
        if (sensorFilter) {
            if (sensorFilter === '激光雷达' && !brand.sensors.includes('激光雷达')) {
                match = false;
            } else if (sensorFilter === '摄像头' && !brand.sensors.includes('摄像头为主')) {
                match = false;
            }
        }
        
        if (match) {
            filteredBrands[key] = brand;
        }
    }
    
    // 显示筛选结果
    displayBrands(filteredBrands);
}

// 重置筛选条件
function resetFilters() {
    document.getElementById('originFilter').value = '';
    document.getElementById('levelFilter').value = '';
    document.getElementById('sensorFilter').value = '';
    
    // 显示所有品牌
    displayBrands(drivingBrands);
}

// 显示品牌列表
function displayBrands(brands) {
    const brandsList = document.getElementById('brandsList');
    if (!brandsList) return;
    
    // 清空现有内容
    brandsList.innerHTML = '';
    
    // 如果没有匹配的品牌，显示提示信息
    if (Object.keys(brands).length === 0) {
        brandsList.innerHTML = `
            <div style="text-align: center; padding: 4rem; color: #64748b;">
                <h3>没有找到匹配的品牌</h3>
                <p>请调整筛选条件后重试</p>
                <button class="btn btn-primary" onclick="resetFilters()">重置筛选</button>
            </div>
        `;
        return;
    }
    
    // 添加品牌列表
    for (const [key, brand] of Object.entries(brands)) {
        const brandItem = document.createElement('div');
        brandItem.className = 'brand-item';
        
        // 为华为品牌添加特殊背景图片
        if (key === 'huawei') {
            brandItem.style.backgroundImage = 'url("huawei-ads4.jpg")';
            brandItem.style.backgroundSize = 'cover';
            brandItem.style.backgroundPosition = 'center';
            brandItem.style.color = 'white';
            brandItem.style.textShadow = '0 2px 4px rgba(0,0,0,0.5)';
        }
        
        brandItem.innerHTML = `
            <h3>${brand.name}</h3>
            <p><strong>方案名称:</strong> ${brand.solution}</p>
            <p><strong>品牌 origin:</strong> ${brand.origin}</p>
            <p><strong>自动驾驶等级:</strong> ${brand.level}</p>
            <p><strong>传感器配置:</strong> ${brand.sensors}</p>
            <p><strong>主要功能:</strong> ${brand.features.substring(0, 100)}...</p>
            <a href="#" class="btn btn-primary" onclick="showBrandDetail('${key}')">查看详情</a>
        `;
        
        // 添加入场动画
        brandItem.style.opacity = '0';
        brandItem.style.transform = 'translateY(20px)';
        
        brandsList.appendChild(brandItem);
        
        // 触发动画
        setTimeout(() => {
            brandItem.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
            brandItem.style.opacity = '1';
            brandItem.style.transform = 'translateY(0)';
        }, Object.keys(brands).indexOf(key) * 100);
    }
}

// 显示品牌详情
function showBrandDetail(brandKey) {
    const brand = drivingBrands[brandKey];
    if (!brand) return;
    
    // 创建详情弹窗
    const modal = document.createElement('div');
    modal.className = 'modal';
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
    `;
    
    const modalContent = document.createElement('div');
    
    // 为华为品牌的详情弹窗添加特殊样式
    let contentStyle = `
        padding: 2rem;
        border-radius: 8px;
        max-width: 600px;
        width: 90%;
        max-height: 80%;
        overflow-y: auto;
    `;
    
    let textColor = '#333';
    
    if (brandKey === 'huawei') {
        contentStyle += `
            background-image: url("huawei-ads4.jpg");
            background-size: cover;
            background-position: center;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        `;
        textColor = 'white';
    } else {
        contentStyle += `
            background-color: white;
        `;
    }
    
    modalContent.style.cssText = contentStyle;
    
    modalContent.innerHTML = `
        <h2>${brand.name} - ${brand.solution}</h2>
        <div style="margin-top: 1rem;">
            <p><strong>品牌 origin:</strong> ${brand.origin}</p>
            <p><strong>自动驾驶等级:</strong> ${brand.level}</p>
            <p><strong>传感器配置:</strong> ${brand.sensors}</p>
            <p><strong>主要功能:</strong> ${brand.features}</p>
            <p><strong>价格:</strong> ${brand.price}</p>
            <p><strong>优势:</strong> ${brand.advantage}</p>
            <p><strong>劣势:</strong> ${brand.disadvantage}</p>
        </div>
        <button id="closeModal" class="btn btn-primary" style="margin-top: 1rem; color: ${textColor === 'white' ? '#333' : 'white'}; background-color: ${textColor === 'white' ? 'white' : '#667eea'}; border: ${textColor === 'white' ? 'none' : '2px solid white'};">关闭</button>
    `;
    
    modal.appendChild(modalContent);
    document.body.appendChild(modal);
    
    // 关闭弹窗
    const closeBtn = document.getElementById('closeModal');
    closeBtn.addEventListener('click', function() {
        document.body.removeChild(modal);
    });
    
    // 点击弹窗外部关闭
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            document.body.removeChild(modal);
        }
    });
}
